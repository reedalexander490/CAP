@echo off
echo ========================================
echo  Command Generator Executable Builder
echo ========================================
echo.
 
REM Check if Python is installed
python --version >nul 2>&1
if errorlevel 1 (
    echo ERROR: Python is not installed or not in PATH
echo Please install Python from https://python.org
    pause
    exit /b 1
)
 
echo Python found:
python --version
echo.
 
REM Check if PyInstaller is installed
echo Checking for PyInstaller...
pip show pyinstaller >nul 2>&1
if errorlevel 1 (
    echo PyInstaller not found. Installing...
    pip install pyinstaller
    if errorlevel 1 (
        echo ERROR: Failed to install PyInstaller
        pause
        exit /b 1
    )
    echo PyInstaller installed successfully!
) else (
    echo PyInstaller is already installed.
)
echo.
 
REM Check if the Python script exists
if not exist "command_generator.py" (
echo ERROR: command_generator.py not found in current directory
    echo Please make sure the Python script is in the same folder as this batch file
    pause
    exit /b 1
)
 
echo Building executable...
echo This may take a few minutes...
echo.
 
REM Build the executable
pyinstaller --onefile --console --name "CommandGenerator" command_generator.py
 
if errorlevel 1 (
    echo ERROR: Failed to build executable
    pause
    exit /b 1
)
 
echo.
echo ========================================
echo BUILD COMPLETED SUCCESSFULLY!
echo ========================================
echo.
echo Your executable is located at: dist\CommandGenerator.exe
echo.
echo Cleaning up temporary files...
 
REM Clean up build files but keep the executable
if exist "build" rmdir /s /q "build"
if exist "CommandGenerator.spec" del "CommandGenerator.spec"
 
echo.
echo The executable is ready to use and transfer!
echo You can find it in the 'dist' folder.
echo.
pause